<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login - KOPO HOTEL</title>
  <style>
    body {
        margin: 0;
        color: #333;
        background: #f0f4f8; /* Light background for a clean look */
        font-family: 'Arial', sans-serif;
    }
    *,:after,:before { box-sizing: border-box; }
    .clearfix:after,.clearfix:before { content: ''; display: table; }
    .clearfix:after { clear: both; display: block; }
    a { color: inherit; text-decoration: none; }

    .login-wrap {
        width: 100%;
        margin: auto;
        max-width: 600px;
        min-height: 700px;
        position: relative;
        background: #ffffff; /* White background for the form */
        border-radius: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 30px;
    }

    .login-html {
        width: 100%;
        height: 100%;
        position: relative;
        background: #e0f2f1; /* Mint background */
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
    }

    .login-html .sign-in-htm,
    .login-html .sign-up-htm {
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        position: absolute;
        transform: rotateY(180deg);
        backface-visibility: hidden;
        transition: all .4s linear;
    }

    .login-html .tab {
        font-size: 20px;
        margin-right: 20px;
        padding-bottom: 10px;
        display: inline-block;
        border-bottom: 2px solid transparent;
        cursor: pointer;
        color: #00796b; /* Minty color for tabs */
        font-weight: bold;
        transition: color .3s, border-color .3s;
    }

    .login-html .tab:hover,
    .login-html .sign-in:checked + .tab,
    .login-html .sign-up:checked + .tab {
        color: #004d40; /* Darker mint for active state */
        border-color: #004d40;
    }

    .login-form {
        position: relative;
        perspective: 1000px;
        transform-style: preserve-3d;
    }

    .login-form .group {
        margin-bottom: 20px;
    }

    .login-form .group .label,
    .login-form .group .input,
    .login-form .group .button {
        width: 100%;
        display: block;
    }

    .login-form .group .input,
    .login-form .group .button {
        border: none;
        padding: 15px;
        border-radius: 25px;
        background: #ffffff; /* White input fields */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .login-form .group input[data-type="password"] {
        text-security: circle;
        -webkit-text-security: circle;
    }

    .login-form .group .label {
        color: #004d40; /* Dark mint for labels */
        font-size: 14px;
    }

    .login-form .group .button {
        background: #00796b; /* Mint green for buttons */
        color: #ffffff;
        cursor: pointer;
        transition: background .3s;
    }

    .login-form .group .button:hover {
        background: #004d40; /* Darker mint for button hover */
    }

    .login-html .sign-in:checked + .tab + .sign-up + .tab + .login-form .sign-in-htm {
        transform: rotate(0);
    }
    .login-html .sign-up:checked + .tab + .login-form .sign-up-htm {
        transform: rotate(0);
    }

    .hr {
        height: 1px;
        margin: 30px 0;
        background: #d0d0d0;
    }

    .foot-lnk {
        text-align: center;
    }
    .foot-lnk label {
        color: #00796b;
        font-weight: bold;
        cursor: pointer;
        transition: color .3s;
    }

    .foot-lnk label:hover {
        color: #004d40;
    }

    #successMessage {
        display: none;
        position: absolute;
        top: 20px;
        right: 20px;
        background: #00796b;
        color: #fff;
        padding: 10px 20px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body>
<div class="login-wrap">
  <div class="login-html">
    <input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1" class="tab">Sign In</label>
    <input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2" class="tab">Sign Up</label>
    <div class="login-form">
      <!-- Sign In -->
      <div class="sign-in-htm">
        <form id="signInForm" action="/membership/signIn" method="post">
          <div class="group">
            <label for="loginId" class="label">Username</label>
            <input id="loginId" name="userId" type="text" class="input" placeholder="Enter your username">
          </div>
          <div class="group">
            <label for="loginPw" class="label">Password</label>
            <input id="loginPw" name="password" type="password" class="input" data-type="password" placeholder="Enter your password">
          </div>
          <div class="group">
            <input id="check" type="checkbox" class="check" checked>
            <label for="check"><span class="icon"></span> Keep me Signed in</label>
          </div>
          <div class="group">
            <input type="submit" class="button" value="Sign In">
          </div>
          <div class="hr"></div>
          <div class="foot-lnk">
            <label for="tab-2">I'm New</label>
          </div>
        </form>
      </div>

      <!-- Sign Up -->
      <div class="sign-up-htm">
        <form id="signUpForm" action="/membership/signUp" method="post">
          <div class="group">
            <label for="name" class="label">Name</label>
            <input id="name" name="name" type="text" class="input" placeholder="Enter your name">
          </div>
          <div class="group">
            <label for="userId" class="label">Username</label>
            <input id="userId" name="userId" type="text" class="input" placeholder="Choose a username">
          </div>
          <div class="group">
            <label for="password" class="label">Password</label>
            <input id="password" name="password" type="password" class="input" data-type="password" placeholder="Choose a password">
          </div>
          <div class="group">
            <label for="phoneNum" class="label">Phone Number</label>
            <input id="phoneNum" name="phoneNum" type="text" class="input" placeholder="Enter your phone number">
          </div>
          <div class="group">
            <input type="submit" class="button" value="Sign Up">
          </div>
          <div class="hr"></div>
          <div class="foot-lnk">
            <label for="tab-1">Already Member?</label>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  function validateForm(formId) {
      const form = document.getElementById(formId);
      const inputs = form.querySelectorAll('.input');
      for (const input of inputs) {
          if (!input.value.trim()) {
              alert('Please fill out all fields.');
              return false;
          }
      }
      return true;
  }

  async function checkUserIdExists(userId) {
      const response = await fetch(`/membership/checkUserId?userId=${userId}`);
      const exists = await response.json();
      return exists;
  }

  document.getElementById('signInForm').addEventListener('submit', function(event) {
      if (!validateForm('signInForm')) {
          event.preventDefault(); // Prevent form submission if validation fails
      }
  });

  document.getElementById('signUpForm').addEventListener('submit', async function(event) {
      if (!validateForm('signUpForm')) {
          event.preventDefault(); // Prevent form submission if validation fails
      } else {
          const userIdInput = document.getElementById('userId');
          const userId = userIdInput.value.trim();
          const userIdExists = await checkUserIdExists(userId);
          if (userIdExists) {
              alert('Username already exists. Please choose another one.');
              event.preventDefault(); // Prevent form submission if userId already exists
          }
      }
  });

  // Display success message if available
  window.onload = function() {
    const successMessage = document.getElementById('successMessage');
    if (successMessage && successMessage.textContent) {
        alert(successMessage.textContent);
    }
  }
</script>

<!-- Include success message element -->
<div id="successMessage" style="display: none;" th:if="${success}" th:text="${success}"></div>

</body>
</html>
